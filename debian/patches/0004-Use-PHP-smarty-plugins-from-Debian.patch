From: =?utf-8?q?S=C3=A9bastien_Delafond?= <sdelafond@gmail.com>
Date: Tue, 20 Nov 2018 11:22:10 +0100
Subject: Use PHP smarty plugins from Debian

---
 www/api/class/centreon_configuration_broker.class.php            | 4 ++--
 www/api/class/centreon_home_customview.class.php                 | 4 ++--
 www/include/common/common-Func.php                               | 4 ++--
 www/include/configuration/configObject/command/formArguments.php | 2 +-
 www/include/configuration/configObject/command/formMacros.php    | 2 +-
 www/install/steps/functions.php                                  | 4 ++--
 6 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/www/api/class/centreon_configuration_broker.class.php b/www/api/class/centreon_configuration_broker.class.php
index ef9b307..bd17cc5 100644
--- a/www/api/class/centreon_configuration_broker.class.php
+++ b/www/api/class/centreon_configuration_broker.class.php
@@ -85,14 +85,14 @@ class CentreonConfigurationBroker extends CentreonConfigurationObjects
          * Smarty template Init
          */
         $libDir = __DIR__ . "/../../../GPL_LIB";
-        $smartyDir = '/usr/share/php/smarty3';
+        $smartyDir = '/usr/share/php/smarty3/';
         require_once $smartyDir . 'Smarty.class.php';
         $tpl = new \Smarty();
         $tpl->compile_dir = $libDir . '/SmartyCache/compile';
         $tpl->config_dir = $libDir . '/SmartyCache/config';
         $tpl->cache_dir = $libDir . '/SmartyCache/cache';
         $tpl->template_dir = _CENTREON_PATH_ . '/www/include/configuration/configCentreonBroker/';
-        $tpl->plugins_dir[] = $libDir . '/smarty-plugins';
+        $tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
 
         $tpl->caching = 0;
         $tpl->compile_check = true;
diff --git a/www/api/class/centreon_home_customview.class.php b/www/api/class/centreon_home_customview.class.php
index 1ec323e..db08efd 100644
--- a/www/api/class/centreon_home_customview.class.php
+++ b/www/api/class/centreon_home_customview.class.php
@@ -185,7 +185,7 @@ class CentreonHomeCustomview extends CentreonWebService
         require_once _CENTREON_PATH_ . "www/class/centreonWidget/Params/Compare.class.php";
         require_once _CENTREON_PATH_ . "www/class/centreonWidget/Params/Sort.class.php";
         require_once _CENTREON_PATH_ . "www/class/centreonWidget/Params/Date.class.php";
-        $smartyDir = '/usr/share/php/smarty3';
+        $smartyDir = '/usr/share/php/smarty3/';
         require_once $smartyDir . 'Smarty.class.php';
 
         global $centreon;
@@ -223,7 +223,7 @@ class CentreonHomeCustomview extends CentreonWebService
         $tpl->config_dir = $libDir . '/SmartyCache/config';
         $tpl->cache_dir = $libDir . '/SmartyCache/cache';
         $tpl->template_dir = _CENTREON_PATH_ . '/www/include/home/customViews/';
-        $tpl->plugins_dir[] = $libDir . '/smarty-plugins';
+        $tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
         $tpl->caching = 0;
         $tpl->compile_check = true;
         $tpl->force_compile = true;
diff --git a/www/include/common/common-Func.php b/www/include/common/common-Func.php
index c88fcc9..30557c0 100644
--- a/www/include/common/common-Func.php
+++ b/www/include/common/common-Func.php
@@ -170,7 +170,7 @@ function initSmartyTpl($path = null, $tpl = null, $subDir = null)
     $tpl->compile_dir = "../GPL_LIB/SmartyCache/compile";
     $tpl->config_dir = "../GPL_LIB/SmartyCache/config";
     $tpl->cache_dir = "../GPL_LIB/SmartyCache/cache";
-    $tpl->plugins_dir[] = "../GPL_LIB/smarty-plugins";
+    $tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
     $tpl->caching = 0;
     $tpl->compile_check = true;
     $tpl->force_compile = true;
@@ -186,7 +186,7 @@ function initSmartyTplForPopup($path = null, $tpl = null, $subDir = null, $centr
     $tpl->compile_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/compile";
     $tpl->config_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/config";
     $tpl->cache_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/cache";
-    $tpl->plugins_dir[] = _CENTREON_PATH_ . "/GPL_LIB/smarty-plugins";
+    $tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
     $tpl->caching = 0;
     $tpl->compile_check = true;
     $tpl->force_compile = true;
diff --git a/www/include/configuration/configObject/command/formArguments.php b/www/include/configuration/configObject/command/formArguments.php
index 5224294..ea0d905 100644
--- a/www/include/configuration/configObject/command/formArguments.php
+++ b/www/include/configuration/configObject/command/formArguments.php
@@ -113,7 +113,7 @@ $tpl->template_dir = $path;
 $tpl->compile_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/compile";
 $tpl->config_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/config";
 $tpl->cache_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/cache";
-$tpl->plugins_dir[] = _CENTREON_PATH_ . "/GPL_LIB/smarty-plugins";
+$tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
 $tpl->caching = 0;
 $tpl->compile_check = true;
 $tpl->force_compile = true;
diff --git a/www/include/configuration/configObject/command/formMacros.php b/www/include/configuration/configObject/command/formMacros.php
index c411e9c..0743c63 100644
--- a/www/include/configuration/configObject/command/formMacros.php
+++ b/www/include/configuration/configObject/command/formMacros.php
@@ -114,7 +114,7 @@ $tpl->template_dir = $path;
 $tpl->compile_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/compile";
 $tpl->config_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/config";
 $tpl->cache_dir = _CENTREON_PATH_ . "/GPL_LIB/SmartyCache/cache";
-$tpl->plugins_dir[] = _CENTREON_PATH_ . "/GPL_LIB/smarty-plugins";
+$tpl->plugins_dir[] = '/usr/share/php/smarty3/plugins';
 $tpl->caching = 0;
 $tpl->compile_check = true;
 $tpl->force_compile = true;
diff --git a/www/install/steps/functions.php b/www/install/steps/functions.php
index 676abf9..5a1c86f 100644
--- a/www/install/steps/functions.php
+++ b/www/install/steps/functions.php
@@ -22,13 +22,13 @@ function isSqlComment($str)
 function getTemplate($dir)
 {
     $libDir = __DIR__ . '/../../../GPL_LIB';
-    $smartyDir = '/usr/share/php/smarty3';
+    $smartyDir = '/usr/share/php/smarty3/';
     require_once $smartyDir . 'Smarty.class.php';
     $template = new \Smarty();
     $template->compile_dir = $libDir . '/SmartyCache/compile';
     $template->config_dir = $libDir . '/SmartyCache/config';
     $template->cache_dir = $libDir . '/SmartyCache/cache';
-    $template->plugins_dir[] = $libDir . "/smarty-plugins";
+    $template->plugins_dir[] = '/usr/share/php/smarty3/plugins';
     $template->template_dir = $dir;
     $template->caching = 0;
     $template->compile_check = true;
